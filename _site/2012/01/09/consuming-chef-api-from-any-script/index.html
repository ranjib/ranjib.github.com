<!DOCTYPE HTML>

<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="author" content="Your Name" />
    <title>Consuming chef api from any script  -  part 1</title>
  <link rel="stylesheet" href="/css/bootstrap.css" />
  </head>
  <body>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <header>
      <h1><a href="/">Consuming chef api from any script  -  part 1</a></h1>
    </header>
      <div class="row">
          <div class="span3">
            <ul>
              
              <li>
                <a href="/2012/09/02/chef-pattern-1-modeling-environment-specific">Chef Pattern 1 :: Modeling environment specific differences</a>
              </li>
              
              <li>
                <a href="/2012/08/16/generic-linux-system-debugging">Generic linux system debugging</a>
              </li>
              
              <li>
                <a href="/2012/08/14/evolving-enterprise-infrastructure-using-chef">Evolving enterprise infrastructure using Chef</a>
              </li>
              
              <li>
                <a href="/2012/08/14/aws-vpc-networking-for-beginners">AWS -VPC Networking for beginners</a>
              </li>
              
              <li>
                <a href="/2012/06/04/units-of-elasticity-thinking-beyond-autoscali">Units of elasticity, thinking beyond autoscaling </a>
              </li>
              
              <li>
                <a href="/2012/05/23/evolution-in-the-configuration-management-sys">Evolution in the configuration management systems arena and alternate workflows</a>
              </li>
              
              <li>
                <a href="/2012/04/15/chef-maintaining-the-shape">Chef:: Maintaining the shape</a>
              </li>
              
              <li>
                <a href="/2012/04/03/infrastructure-tooling-anti-patterns-accumula">Infrastructure tooling anti-patterns : Accumulator</a>
              </li>
              
              <li>
                <a href="/2012/03/12/infrastructure-elasticity">Infrastructure elasticity</a>
              </li>
              
              <li>
                <a href="/2012/03/06/why-continuous-delivery-is-feasible-now">Why continuous delivery is feasible now?</a>
              </li>
              
              <li>
                <a href="/2012/03/04/monitoring">Monitoring?</a>
              </li>
              
              <li>
                <a href="/2012/02/24/learning-from-agile-india-2012-conference">Learning from Agile India 2012 conference</a>
              </li>
              
              <li>
                <a href="/2012/02/24/infrastructure-tooling-patterns">Infrastructure tooling patterns</a>
              </li>
              
              <li>
                <a href="/2012/01/09/consuming-chef-api-from-any-script">Consuming chef api from any script  -  part 1</a>
              </li>
              
              <li>
                <a href="/2011/10/24/have-money-baby-will-farm">Have money? Baby will farm.</a>
              </li>
              
            </ul>
          </div>
          <div class="span9">
            <p>Its been more than a year since we have adopted chef for ThoughtWorks. We use chef not only for configuration management but also for provisioning instances.Â  Since most of our infrastructure is automated many of the services needs to integrate with chef programmatically. Knife, the command line interface of chef provides easy integration via knife plugin and knife exec. But in this post i&rsquo;ll showcase how chef can be used from any script if you have an api client configured. At bare minimum we need to set three parameters to get our script talking to a chef server, these are chef server url, node_name and client key. Once configured we can use chef api to interact with chef server. Lets start with enlisting the number of nodes</p>

<div class="CodeRay">
  <div class="code"><pre>require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">chef</span><span class="delimiter">'</span></span>  

<span class="constant">Chef</span>::<span class="constant">Config</span>[<span class="symbol">:node_name</span>]=<span class="string"><span class="delimiter">'</span><span class="content">client_name</span><span class="delimiter">'</span></span>
<span class="constant">Chef</span>::<span class="constant">Config</span>[<span class="symbol">:client_key</span>]=<span class="string"><span class="delimiter">'</span><span class="content">path to client cert.pem</span><span class="delimiter">'</span></span>
<span class="constant">Chef</span>::<span class="constant">Config</span>[<span class="symbol">:chef_server_url</span>]=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://ur chef server:4000</span><span class="delimiter">&quot;</span></span>     

<span class="constant">Chef</span>::<span class="constant">Node</span>.list.each <span class="keyword">do</span> |node|  
    puts node.first      
<span class="keyword">end</span></pre></div>
</div>


          </div>
      </div>
  </body>
</html>

